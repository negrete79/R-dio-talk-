<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste de Conexão - Câmera</title>
    <script src="https://unpkg.com/peerjs@1.5.1/dist/peerjs.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; background: #333; color: #fff; text-align: center; padding: 20px; }
        #id-display { font-size: 24px; font-weight: bold; color: #4CAF50; background: #222; padding: 20px; border-radius: 8px; margin: 20px; }
        #status { font-size: 20px; margin-top: 20px; }
    </style>
</head>
<body>
    <h1>Teste de Conexão (Câmera)</h1>
    <p>Aguarde o ID aparecer...</p>
    <div id="id-display">Gerando...</div>
    <div id="status">Aguardando conexão...</div>

    <script>
        const idDisplay = document.getElementById('id-display');
        const statusDiv = document.getElementById('status');
        const peerId = 'test-' + Math.random().toString(36).substr(2, 9);

        const peer = new Peer(peerId);

        peer.on('open', (id) => {
            idDisplay.textContent = `MEU ID É:\n${id}`;
            statusDiv.textContent = 'Pronto! Aguardando o outro dispositivo se conectar...';
            console.log('Meu ID é: ' + id);
        });

        peer.on('connection', (conn) => {
            statusDiv.textContent = '✅ CONECTADO! O outro dispositivo me encontrou.';
            console.log('Conectado com: ' + conn.peer);
            
            conn.on('data', (data) => {
                statusDiv.textContent = `✅ Conectado! Mensagem recebida: "${data}"`;
            });
        });

        peer.on('error', (err) => {
            statusDiv.textContent = `❌ ERRO: ${err.type} - ${err.message}`;
            console.error('Erro no Peer:', err);
        });
    </script>
</body>
</html>